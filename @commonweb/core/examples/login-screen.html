<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Todo App</title>
</head>
<script src="https://cdn.tailwindcss.com"></script>

<style>
    /* width */
    ::-webkit-scrollbar {
        width: 2px;
    }

    /* Track */
    ::-webkit-scrollbar-track {
        background: rgb(20, 28, 51);
    }

    /* Handle */
    ::-webkit-scrollbar-thumb {
        background: #06b6d4;
        border-radius: 5px;
    }

    /* Handle on hover */
    ::-webkit-scrollbar-thumb:hover {
        background: #006b7d;
    }

    .loop-injected > li {
        animation: NAME-YOUR-ANIMATION 0.1s;
    }

    @-webkit-keyframes NAME-YOUR-ANIMATION {
        0%, 49% {
            background-color: white;
        }
        50%, 100% {
            background-color: none;
        }
    }

</style>
<body class="bg-slate-900 p-4 text-slate-50">
<div class="flex gap-4 justify-center">
    <div class="w-[60%] outline outline-cyan-900 p-4  margin-auto  justify-center">
        <h5>TODO</h5>
        <ul class="list-disc p-5">
            <li class="py-4">Proteger ruta con este login, user localstorage clasico par tokens</li>
            <li class="py-4">ver si crear routing or si usar switch case para hacer estilo pop/push
                de las vistas, NOTA afectaria a la larga en el desktop?? focus mobile only?
            </li>
            <li class="py-4">Usuario seran auto gestionados, quizas no hace falta login con facebook y otra tool</li>
            <li class="py-4">Metodo para recuperar contrase;a ??</li>

        </ul>
    </div>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"/>

    <div class="rounded-lg w-[332px] h-[632px] outline  outline-cyan-900 flex  margin-auto items-center  justify-center">
        <div class="m-auto w-[100%] p-5">
            <div class="flex justify-center text-3xl gap-3 mb-20">
                <span class="material-symbols-outlined">exercise</span>
                ChinoFitness
            </div>
            <web-form>
                <div class="my-4">
                    <form-field format="text" placeholder="aaron@domain.com"
                                label="Usuario / Email"></form-field>
                </div>
                <div class="my-2">
                    <form-field class="my-4" placeholder="*******" format="password" label="ContraseÃ±a"></form-field>
                </div>
            </web-form>
            <button class="my-3 w-[100%] bg-blue-500 border border-blue-500 hover:bg-blue-700 text-white font-bold rounded-lg p-2 ">
                login
            </button>
            <p class="text-xs text">Si aun no estas registrado que esperas contacta a Alepo</p>

        </div>
    </div>

    <!--    <api-call method="GET"></api-call>-->
    <!--    <div class="w-[60%] outline outline-cyan-900 p-4  margin-auto  justify-center">-->
    <!--    </div>-->
</div>
<script src="../dist/lib-pkg.js" type="text/javascript"></script>

<script>
    if (window.RegisterWebComponent) {

        window
            .RegisterWebComponent({
                selector: 'web-form',
                template: `<slot></slot>`,
                // so we can take global style rules
            })
            .with_method("submit", function () {
                const selects = this.querySelectorAll("form-select")
                const value = {};
                const formFields = this.querySelectorAll("form-field")
                formFields.forEach((input) => value[input.getAttribute("property")] = input.value());
                selects.forEach((input) => value[input.getAttribute("property")] = input.value());

                const event = new CustomEvent("submit", {detail: {data: value}});
                this.dispatchEvent(event)
            })
            .with_method("reset", function () {
                const inputs = this.querySelectorAll("form-field")
                const select = this.querySelectorAll("select")
                inputs.forEach((input) => input.reset());
                select.forEach((input) => input.value = "");
            })
            .build();


        window
            .RegisterWebComponent({
                //language=css
                style: `
                    :host {
                        display: block;
                    }`,
                selector: 'form-field',
                // language=HTML
                template: `

                    <label for="">{{@host.label}}</label>
                    <input
                            placeholder="{{@host.placeholder}}"
                            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                            type="{{@host.format}}">
                `,
                useShadow: false,

                // so we can take global style rules,
            })
            .with_attribute("placeholder", "")
            .with_attribute("format", "text")
            .with_attribute("label", "")
            .with_attribute("property", "")
            .with_attribute("value", function () {
                return this.querySelector("input").value;
            })
            .with_method("reset", function () {
                this.querySelector("input").value = "";
            })
            .with_method("setValue", function (value) {
                this.querySelector("input").value = value;
            })
            .build();


        window
            .RegisterWebComponent({
                //language=CSS
                style: `
                    .content {
                        position: relative;
                    }

                    .option-list {
                        position: absolute;
                        max-height: 200px;
                        overflow: auto;
                        width: 100%;
                    }

                    .option {
                        background-color: rgb(55 65 81 / var(--tw-bg-opacity));
                        color: white;
                        padding: 1em 0.5em;
                    }

                    .option:hover {
                        background-color: rgb(54 117 219);

                    }

                    .overlay {
                        top: 0;
                        position: fixed;
                        height: 100%;
                        width: 100%;
                        left: 0;
                    }

                    ul {
                        border: none;
                        list-style: none;
                    }
                `,
                selector: 'form-select',
                // language=HTML
                template: `

                    <div class="content">
                        <form-field placeholder="{{@host.placeholder}}" label="{{@host.label}}"></form-field>
                        <bind-element from=input:(focus) to="toggable-element:show"></bind-element>

                        <bind-element from=form-field:(click) to="toggable-element:show"></bind-element>
                        <bind-element from=ul:(click) to="toggable-element:hide"></bind-element>

                        <toggable-element hidden>
                            <div class="overlay"></div>
                            <bind-element from=.overlay:(click) to="toggable-element:hide"></bind-element>
                            <ul class="option-list bg-gray-50 border text-gray-900 cursor-pointer">
                            </ul>
                        </toggable-element>
                    </div>
                `,
                useShadow: false,
            })
            .with_attribute("label-path", "")
            .with_attribute("value-path", "")
            .with_attribute("placeholder", "")
            .with_attribute("label", "")
            .with_attribute("property", "")
            .with_attribute("data", function (data) {
                this._data = data;
            })
            .with_method("value", function () {
                return this._value;
            })
            .with_method("reset", function () {
                if (!this['label-path'] || !this['value-path']) {
                    return;
                }
                if (this._data && Array.isArray(this._data)) {
                    this._data.forEach((item) => {
                        const li = document.createElement("li");
                        // language=HTML
                        const option = `
                            <div value="{{@host.data.${this['value-path']}}}">{{@host.data.${this['label-path']}}}
                            </div>`
                        li.innerHTML = `<template-view></template-view>`;
                        li.classList.add("option")
                        li.children.item(0).setAttribute("data", JSON.stringify(item));
                        li.children.item(0).view = option;


                        li.addEventListener("click", () => {
                            const selected = li.children.item(0).children.item(0);
                            this._value = selected.getAttribute("value");
                            this.querySelector("form-field").setValue(selected.textContent);
                        });


                        this.querySelector(".option-list").appendChild(li);
                    });
                }

            })
            .on_init(function () {
                this.reset();
            })
            .build();

    }

</script>
</body>
</html>
